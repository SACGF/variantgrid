!function(t,e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jsonxml"],function(r){return e(r,t)}):"object"==typeof module&&module.exports?module.exports=function(t,r){return t||(t=window),void 0===r&&(r="undefined"!=typeof window?require("jquery"):require("jquery")(t)),require("./grid.base"),require("./jsonxml"),e(r,t),r}:e(jQuery,t)}("undefined"!=typeof window?window:this,function(t,e){"use strict";var r=t.jgrid;t.jgrid.extend({jqGridImport:function(e){return e=t.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},e||{}),this.each(function(){var i,o=this,s=function(e,i){var s,n,a,p,l=t(i.xmlGrid.config,e)[0],d=t(i.xmlGrid.data,e)[0];if(xmlJsonClass.xml2json){s=xmlJsonClass.xml2json(l," "),s=t.parseJSON(s);for(a in s)s.hasOwnProperty(a)&&(n=s[a]);void 0!==n&&(d?(p=s.grid.datatype,s.grid.datatype="xmlstring",s.grid.datastr=e,t(o).jqGrid(n).jqGrid("setGridParam",{datatype:p})):t(o).jqGrid(n))}else(null!=r.defaults&&t.isFunction(r.defaults.fatalError)?r.defaults.fatalError:alert)("xml2json or parse are not present")},n=function(e,r){if(e&&"string"==typeof e){var i,s=t.parseJSON(e),n=s[r.jsonGrid.config],a=s[r.jsonGrid.data];a?(i=n.datatype,n.datatype="jsonstring",n.datastr=a,t(o).jqGrid(n).jqGrid("setGridParam",{datatype:i})):t(o).jqGrid(n)}};switch(e.imptype){case"xml":t.ajax(t.extend({url:e.impurl,type:e.mtype,data:e.impData,dataType:"xml",context:e,complete:function(e){!(e.status<300||304===e.status)||0===e.status&&4===e.readyState||(s(e.responseXML,this),t(o).triggerHandler("jqGridImportComplete",[e,this]),t.isFunction(this.importComplete)&&this.importComplete(e))}},e.ajaxOptions));break;case"xmlstring":e.impstring&&"string"==typeof e.impstring&&(i=t.parseXML(e.impstring))&&(s(i,e),t(o).triggerHandler("jqGridImportComplete",[i,e]),t.isFunction(e.importComplete)&&e.importComplete(i),e.impstring=null);break;case"json":t.ajax(t.extend({url:e.impurl,type:e.mtype,data:e.impData,dataType:"json",context:e,complete:function(e){try{!(e.status<300||304===e.status)||0===e.status&&4===e.readyState||(n(e.responseText,this),t(o).triggerHandler("jqGridImportComplete",[e,this]),t.isFunction(this.importComplete)&&this.importComplete(e))}catch(t){}}},e.ajaxOptions));break;case"jsonstring":e.impstring&&"string"==typeof e.impstring&&(n(e.impstring,e),t(o).triggerHandler("jqGridImportComplete",[e.impstring,e]),t.isFunction(e.importComplete)&&e.importComplete(e.impstring),e.impstring=null)}})},jqGridExport:function(e){e=t.extend({exptype:"xmlstring",root:"grid",ident:"\t"},e||{});var r=null;return this.each(function(){if(this.grid){var i,o=t.extend(!0,{},t(this).jqGrid("getGridParam"));if(o.rownumbers&&(o.colNames.splice(0,1),o.colModel.splice(0,1)),o.multiselect&&(o.colNames.splice(0,1),o.colModel.splice(0,1)),o.subGrid&&(o.colNames.splice(0,1),o.colModel.splice(0,1)),o.knv=null,o.treeGrid)for(i in o.treeReader)o.treeReader.hasOwnProperty(i)&&(o.colNames.splice(o.colNames.length-1),o.colModel.splice(o.colModel.length-1));switch(e.exptype){case"xmlstring":r="<"+e.root+">"+xmlJsonClass.json2xml(o,e.ident)+"</"+e.root+">";break;case"jsonstring":r="{"+xmlJsonClass.toJson(o,e.root,e.ident,!1)+"}",void 0!==o.postData.filters&&(r=r.replace(/filters":"/,'filters":'),r=r.replace(/\}\]\}"/,"}]}"))}}}),r},excelExport:function(r){return r=t.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},r||{}),this.each(function(){var i;this.grid&&"remote"===r.exptype&&((i=t.extend({},this.p.postData,r.exportOptions))[r.oper]=r.tag,e.location=r.url+(null!=r.url&&r.url.indexOf("?")>=0?"&":"?")+t.param(i))})}})});
//# sourceMappingURL=grid.import.js.map