!function(e,t){"use strict";"function"==typeof define&&define.amd?define(["jquery","./grid.base","./jqdnr","./jqmodal"],function(a){return t(a,e.document)}):"object"==typeof module&&module.exports?module.exports=function(e,a){return e||(e=window),void 0===a&&(a="undefined"!=typeof window?require("jquery"):require("jquery")(e)),require("./grid.base"),require("./jqdnr"),require("./jqmodal"),t(a,e.document),a}:t(jQuery,e.document)}("undefined"!=typeof window?window:this,function(e,t){"use strict";var a=e.jgrid,i=e.fn.jqGrid,o=i.getGuiStyles,l=i.getGridRes;a.jqModal=a.jqModal||{},e.extend(!0,a.jqModal,{toTop:!0}),e.extend(a,{showModal:function(e){e.w.show()},closeModal:function(e){e.w.hide().attr("aria-hidden","true"),e.o&&e.o.remove()},hideModal:function(t,a){var i=!(!(a=e.extend({jqm:!0,gb:"",removemodal:!1},a||{})).gb||"string"!=typeof a.gb||"#gbox_"!==a.gb.substr(0,6))&&e("#"+a.gb.substr(6))[0],o=e(t);if(a.onClose){var l=i?a.onClose.call(i,t):a.onClose(t);if("boolean"==typeof l&&!l)return}if(e.fn.jqm&&!0===a.jqm)o.attr("aria-hidden","true").jqmHide();else{if(""!==a.gb)try{e(">.jqgrid-overlay",a.gb).first().hide()}catch(e){}o.hide().attr("aria-hidden","true")}a.removemodal&&o.remove()},createModal:function(l,n,r,d,s,u,c){var m=a.jqID,f=this.p;r=e.extend(!0,{resizingRightBottomIcon:i.getIconRes.call(this,"form.resizableLtr")},a.jqModal||{},null!=f?f.jqModal||{}:{},r);var h=t.createElement("div"),p="#"+m(l.themodal),F="rtl"===e(r.gbox).attr("dir"),g=!!l.resizeAlso&&"#"+m(l.resizeAlso);c=e.extend({},c||{}),h.className=o.call(this,"dialog.window","ui-jqdialog"),h.id=l.themodal,h.dir=F?"rtl":"ltr";var v=t.createElement("div");v.className=o.call(this,"dialog.document"),e(v).attr("role","document");var x=t.createElement("div");x.className=o.call(this,"dialog.subdocument"),v.appendChild(x),h.appendChild(v);var b=t.createElement("div");b.className=o.call(this,"dialog.header","ui-jqdialog-titlebar "+(F?"ui-jqdialog-titlebar-rtl":"ui-jqdialog-titlebar-ltr")),b.id=l.modalhead,e(b).append("<span class='ui-jqdialog-title'>"+r.caption+"</span>");var q=o.call(this,"states.hover"),y=e("<a aria-label='Close' class='"+o.call(this,"dialog.closeButton","ui-jqdialog-titlebar-close")+"'></a>").hover(function(){y.addClass(q)},function(){y.removeClass(q)}).append("<span class='"+i.getIconRes.call(this,"form.close")+"'></span>");e(b).append(y);var j=t.createElement("div");e(j).addClass(o.call(this,"dialog.content","ui-jqdialog-content")).attr("id",l.modalcontent),e(j).append(n),x.appendChild(j),e(x).prepend(b),!0===u?e("body").append(h):"string"==typeof u?e(u).append(h):e(h).insertBefore(d),e(h).css(c),void 0===r.jqModal&&(r.jqModal=!0);var w={};if(e.fn.jqm&&!0===r.jqModal?(0===r.left&&0===r.top&&r.overlay&&((r=e(s).offset()).left+=4,r.top+=4),w.top=r.top+"px",w.left=r.left):0===r.left&&0===r.top||(w.left=r.left,w.top=r.top+"px"),e("a.ui-jqdialog-titlebar-close",b).click(function(){var t=e(p).data("onClose")||r.onClose,i=e(p).data("gbox")||r.gbox;return a.hideModal(p,{gb:i,jqm:r.jqModal,onClose:t,removemodal:r.removemodal||!1}),!1}),0!==r.width&&r.width||(r.width=300),0!==r.height&&r.height||(r.height=200),!r.zIndex){var C=e(d).parents("*[role=dialog]").first().css("z-index");C?(r.zIndex=parseInt(C,10)+2,r.toTop=!0):r.zIndex=950}if(w.left&&(w.left+="px"),e(h).css(e.extend({width:isNaN(r.width)?"auto":r.width+"px",height:isNaN(r.height)?"auto":r.height+"px",zIndex:r.zIndex},w)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":l.modalhead,"aria-hidden":"true"}),void 0===r.drag&&(r.drag=!0),void 0===r.resize&&(r.resize=!0),r.drag)if(e.fn.jqDrag)e(b).css("cursor","move"),e(h).jqDrag(b);else try{e(h).draggable({handle:e("#"+m(b.id))})}catch(e){}if(r.resize)if(e.fn.jqResize)e(j).append("<div class='jqResize ui-resizable-handle ui-resizable-se "+r.resizingRightBottomIcon+"'></div>"),e(p).jqResize(".jqResize",g);else try{e(h).resizable({handles:"se, sw",alsoResize:g})}catch(e){}!0===r.closeOnEscape&&e(h).keydown(function(t){if(27===t.which){var i=e(p).data("onClose")||r.onClose;a.hideModal(p,{gb:r.gbox,jqm:r.jqModal,onClose:i,removemodal:r.removemodal||!1,formprop:!r.recreateForm||!1,form:r.form||""})}})},viewModal:function(t,i){if(i=e.extend(!0,{overlay:30,modal:!1,overlayClass:o.call(this,"overlay"),onShow:a.showModal,onHide:a.closeModal,gbox:"",jqm:!0,jqM:!0},a.jqModal||{},i||{}),e.fn.jqm&&!0===i.jqm)i.jqM?e(t).attr("aria-hidden","false").jqm(i).jqmShow():e(t).attr("aria-hidden","false").jqmShow();else{""!==i.gbox&&(e(">.jqgrid-overlay",i.gbox).first().show(),e(t).data("gbox",i.gbox)),e(t).show().attr("aria-hidden","false");try{e(":input:visible",t)[0].focus()}catch(e){}}},info_dialog:function(t,i,l,n){var r=this,d=r.p,s=e.extend(!0,{width:290,height:"auto",dataheight:"auto",drag:!0,resize:!1,left:250,top:170,zIndex:1e3,jqModal:!0,modal:!1,closeOnEscape:!0,align:"center",buttonalign:"center",buttons:[]},a.jqModal||{},null!=d?d.jqModal||{}:{},{caption:"<b>"+t+"</b>"},n||{}),u=s.jqModal;e.fn.jqm&&!u&&(u=!1);var c,m="",f=o.call(r,"states.hover");if(s.buttons.length>0)for(c=0;c<s.buttons.length;c++)void 0===s.buttons[c].id&&(s.buttons[c].id="info_button_"+c),m+=a.builderFmButon.call(r,s.buttons[c].id,s.buttons[c].text);var h=isNaN(s.dataheight)?s.dataheight:s.dataheight+"px",p="text-align:"+s.align+";",F=e("#info_dialog"),g="<div id='info_id'>";g+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+h+";"+p+"'>"+i+"</div>",(l||""!==m)&&(g+="<hr class='"+o.call(r,"dialog.hr")+"' style='margin:1px'/><div style='text-align:"+s.buttonalign+";padding:.8em 0 .5em 0;background-image:none;border-width: 1px 0 0 0;'>"+(l?a.builderFmButon.call(r,"closedialog",l):"")+m+"</div>"),g+="</div>";try{"false"===F.attr("aria-hidden")&&a.hideModal("#info_dialog",{jqm:u}),F.remove()}catch(e){}a.createModal.call(r,{themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",resizeAlso:"infocnt"},g,s,"","",!0),F=e("#info_dialog"),m&&e.each(s.buttons,function(){e("#"+a.jqID(this.id),"#info_id").on("click",{click:this.onClick},function(t){return e.isFunction(t.data.click)&&t.data.click.call(r,t,F),!1})}),e("#closedialog","#info_id").click(function(){return a.hideModal("#info_dialog",{jqm:u,onClose:F.data("onClose")||s.onClose,gb:F.data("gbox")||s.gbox}),!1}),e(".fm-button","#info_dialog").hover(function(){e(this).addClass(f)},function(){e(this).removeClass(f)}),e.isFunction(s.beforeOpen)&&s.beforeOpen(),a.viewModal.call(r,"#info_dialog",{onHide:function(e){e.w.hide().remove(),e.o&&e.o.remove()},modal:s.modal,jqm:u}),e.isFunction(s.afterOpen)&&s.afterOpen();try{F.focus()}catch(e){}},bindEv:function(t,a){var i=this;e.isFunction(a.dataInit)&&a.dataInit.call(i,t,a),a.dataEvents&&e.each(a.dataEvents,function(){void 0!==this.data?e(t).on(this.type,"object"==typeof this.data&&null!==this.data?e.extend(!0,{},a,this.data):this.data,this.fn):e(t).on(this.type,a,this.fn)})},createEl:function(i,o,n,r,d){function s(t,i,o){var l=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr","custom_element","custom_value","generateValue","postData","selectFilled","rowId","column","mode","cm","iCol"];void 0!==o&&e.isArray(o)&&e.merge(l,o),e.each(i,function(a,i){-1===e.inArray(a,l)&&e(t).attr(a,i)}),i.hasOwnProperty("id")||e(t).attr("id",a.randId())}var u="",c=this,m=c.p,f=a.info_dialog,h=function(t){return l.call(e(c),t)},p=h("errors.errcap"),F=h("edit"),g=F.msg,v=F.bClose;if(null==o)return"";switch(i){case"textarea":u=t.createElement("textarea"),r?o.cols||e(u).css({width:"100%","box-sizing":"border-box"}):o.cols||(o.cols=19),o.rows||(o.rows=2),("&nbsp;"===n||"&#160;"===n||1===n.length&&160===n.charCodeAt(0))&&(n=""),u.value=n,s(u,o),e(u).attr({role:"textbox"});break;case"checkbox":if(u=t.createElement("input"),u.type="checkbox",o.value){var x=o.value.split(":");n===x[0]&&(u.checked=!0,u.defaultChecked=!0),u.value=x[0],e(u).data("offval",x[1])}else{var b=String(n).toLowerCase();b.search(/(false|f|0|no|n|off|undefined)/i)<0&&""!==b?(u.checked=!0,u.defaultChecked=!0,u.value=n):u.value="on",e(u).data("offval","off")}s(u,o,["value"]),e(u).attr({role:"checkbox","aria-checked":u.checked?"true":"false"});break;case"select":u=t.createElement("select");var q,y=[],j=null;!0===o.multiple||"multiple"===o.multiple?(q=!0,u.multiple="multiple",e(u).attr("aria-multiselectable","true"),y=n.split(","),y=e.map(y,function(t){return e.trim(t)})):(q=!1,y[0]=e.trim(n)),void 0===o.size&&(o.size=q?3:1);try{j=o.rowId}catch(e){}if(m&&m.idPrefix&&(j=a.stripPref(m.idPrefix,j)),void 0===o.dataUrl&&o.generateValue&&null!=m.indexByColumnData[o.cm.name]&&(o.value=c.generateValueFromColumnIndex(o.cm.name,o.separator,o.delimiter)),void 0!==o.dataUrl){var w=o.postData||d.postData,C={elem:u,options:o,cm:o.cm,mode:o.mode,rowid:j,iCol:o.iCol,ovm:y};s(u,o,w?["postData"]:void 0),e.ajax(e.extend({url:e.isFunction(o.dataUrl)?o.dataUrl.call(c,j,n,String(o.name),C):o.dataUrl,type:"GET",dataType:"html",data:e.isFunction(w)?w.call(c,j,n,String(o.name)):w,context:C,success:function(t,i,o){var l=this.ovm,n=this.elem,r=this.cm,d=this.iCol,s=e.extend({},this.options),u=this.rowid,m=this.mode,f=e.isFunction(s.buildSelect)?s.buildSelect.call(c,t,o,r,d):t;"string"==typeof f&&(f=e(e.trim(f)).html()),f&&(e(n).append(f),setTimeout(function(){var t;e("option",n).each(function(a){0===a&&n.multiple&&(this.selected=!1),e.inArray(e.trim(e(this).val()),l)>-1&&(this.selected=!0,t=!0)}),t||e("option",n).each(function(){e.inArray(e.trim(e(this).text()),l)>-1&&(this.selected=!0)}),a.fullBoolFeedback.call(c,s.selectFilled,"jqGridSelectFilled",{elem:n,options:s,cm:r,rowid:u,mode:m,cmName:null!=r?r.name:s.name,iCol:d})},0))}},d||{}))}else o.value&&(a.fillSelectOptions(u,o.value,void 0===o.separator?":":o.separator,void 0===o.delimiter?";":o.delimiter,q,n),s(u,o,["value"]),a.fullBoolFeedback.call(c,o.selectFilled,"jqGridSelectFilled",{elem:u,options:o,cm:o.cm,rowid:j,mode:o.mode,cmName:null!=o.cm?o.cm.name:o.name,iCol:o.iCol}));break;case"text":case"password":case"button":var D;D="button"===i?"button":"textbox",(u=t.createElement("input")).type=i,s(u,o),u.value=n,"button"!==i&&(r?o.size||e(u).css({width:"100%","box-sizing":"border-box"}):o.size||(o.size=20)),e(u).attr("role",D);break;case"image":case"file":(u=t.createElement("input")).type=i,s(u,o);break;case"custom":u=t.createElement("span");try{if(!e.isFunction(o.custom_element))throw"editoptions.custom_element is not a function";var z=o.custom_element.call(c,n,o);if(!(z instanceof jQuery||a.isHTMLElement(z)||"string"==typeof z))throw"editoptions.custom_element returns value of a wrong type";z=e(z).addClass("customelement").attr({id:o.id,name:o.name}),e(u).empty().append(z)}catch(e){"e1"===e&&f.call(c,p,"function 'custom_element' "+g.nodefined,v),"e2"===e?f.call(c,p,"function 'custom_element' "+g.novalue,v):f.call(c,p,"string"==typeof e?e:e.message,v)}}return u},checkDate:function(e,t){var a,i={};if(e=e.toLowerCase(),a=-1!==e.indexOf("/")?"/":-1!==e.indexOf("-")?"-":-1!==e.indexOf(".")?".":"/",e=e.split(a),3!==(t=t.split(a)).length)return!1;var o,l,n,r=-1,d=-1,s=-1;for(l=0;l<e.length;l++)n=isNaN(t[l])?0:parseInt(t[l],10),i[e[l]]=n,-1!==(o=e[l]).indexOf("y")&&(r=l),-1!==o.indexOf("m")&&(s=l),-1!==o.indexOf("d")&&(d=l);o="y"===e[r]||"yyyy"===e[r]?4:"yy"===e[r]?2:-1;var u,c=[0,31,29,31,30,31,30,31,31,30,31,30,31];return-1!==r&&(u=i[e[r]].toString(),2===o&&1===u.length&&(o=1),u.length===o&&(0!==i[e[r]]||"00"===t[r])&&(-1!==s&&(!((u=i[e[s]].toString()).length<1||i[e[s]]<1||i[e[s]]>12)&&(-1!==d&&!((u=i[e[d]].toString()).length<1||i[e[d]]<1||i[e[d]]>31||2===i[e[s]]&&i[e[d]]>function(e){return e%4!=0||e%100==0&&e%400!=0?28:29}(i[e[r]])||i[e[d]]>c[i[e[s]]])))))},isEmpty:function(e){return!(!e.match(/^\s+$/)&&""!==e)},checkTime:function(e){var t,i=/^(\d{1,2}):(\d{2})([apAP][Mm])?$/;if(!a.isEmpty(e)){if(!(t=e.match(i)))return!1;if(t[3]){if(t[1]<1||t[1]>12)return!1}else if(t[1]>23)return!1;if(t[2]>59)return!1}return!0},checkValues:function(t,i,o,n,r){var d,s,u,c,m,f=this,h=f.p,p=h.colModel,F=a.isEmpty,g=l.call(e(f),"edit.msg"),v=function(t){var a=d[t];return e.isFunction(a)?a.call(f,r):a},x=l.call(e(f),"formatter.date.masks");if(void 0===o){if("string"==typeof i&&(i=h.iColByName[i]),void 0===i||i<0)return[!0,"",""];c=p[i],d=c.editrules,null!=c.formoptions&&(s=c.formoptions.label)}else d=o,s=void 0===n?"_":n,c=p[i];if(d){if(s||(s=null!=h.colNames?h.colNames[i]:c.label),!0===v("required")&&F(t))return[!1,s+": "+g.required,""];var b=!1!==v("required");if(!0===v("number")&&(!1!==b||!F(t))&&isNaN(t))return[!1,s+": "+g.number,""];if(void 0!==d.minValue&&!isNaN(d.minValue)&&parseFloat(t)<parseFloat(d.minValue))return[!1,s+": "+g.minValue+" "+d.minValue,""];if(void 0!==d.maxValue&&!isNaN(d.maxValue)&&parseFloat(t)>parseFloat(d.maxValue))return[!1,s+": "+g.maxValue+" "+d.maxValue,""];if(!0===v("email")&&!(!1===b&&F(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(t)))return[!1,s+": "+g.email,""];if(!0===v("integer")&&(!1!==b||!F(t))){if(isNaN(t))return[!1,s+": "+g.integer,""];if(t%1!=0||-1!==t.indexOf("."))return[!1,s+": "+g.integer,""]}if(!0===v("date")&&!(!1===b&&F(t)||(c.formatoptions&&c.formatoptions.newformat?(u=c.formatoptions.newformat,x.hasOwnProperty(u)&&(u=x[u])):u=p[i].datefmt||"Y-m-d",a.checkDate(u,t))))return[!1,s+": "+g.date+" - "+u,""];if(!0===v("time")&&!(!1===b&&F(t)||a.checkTime(t)))return[!1,s+": "+g.date+" - hh:mm (am/pm)",""];if(!0===v("url")&&!(!1===b&&F(t)||/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i.test(t)))return[!1,s+": "+g.url,""];if(!0===d.custom){if(!1!==b||!F(t))return e.isFunction(d.custom_func)?(m=d.custom_func.call(f,t,s,i),e.isArray(m)?m:[!1,g.customarray,""]):[!1,g.customfcheck,""]}else if(e.isFunction(d.custom)&&(!1!==b||!F(t)))return m=d.custom.call(f,r),e.isArray(m)?m:[!1,g.customarray,""]}return[!0,"",""]}})});
//# sourceMappingURL=grid.common.js.map