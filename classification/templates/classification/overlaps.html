{% extends "uicore/page/base.html" %}
{% load crispy_forms_tags %}
{% load static %}
{% load js_tags %}
{% load compress %}
{% load ui_utils %}
{% load ui_help %}
{% load ui_menu_bars %}
{% load settings_tags %}
{% load classification_tags %}
{% load lab_tags %}
{% block title %}Conflicts{% endblock %}
{% block submenu %}{% menu_bar_classifications %}{% endblock submenu %}
{% block head %}
    <style>
        .dt-context {
            width: 25%;
        }
        .dt-c_hgvs {
            width: 23%;
        }
        .dt-severity {
            width: 12%;
        }
        .dt-involved-labs {
            width: 40%;
        }
        .table thead th {
            border-top: none;
        }
    </style>
    <script>
        const debouncedFilterGrid = debounce(filterGrid);
        function filterGrid() {
            $('#conflicts-datatable').DataTable().ajax.reload();
        }

        function conflictFilter(data) {
            data.lab = "{{ dlab.lab_ids_str }}";
            // data.status = $('#status-tab').val();
            //data.exclude_unknown = $('#filter_unknown').is(":checked");
            //data.multiple_submitters = $('#multiple_submitters').is(":checked");
        }

        function updateStatus(status) {
            // $('#status-tab').val(status);
            debouncedFilterGrid();
        }

        $(document).ready(() => {
            $('.filter-input').change(() => {
               debouncedFilterGrid();
            }).keyup(() => {
               debouncedFilterGrid();
            });
        });
    </script>
{% endblock %}
{% block content %}
    <div class="container">
        <h4>Classification Record Overlaps</h4>
        {% lab_picker dlab.lab_picker %}

        <table id="conflicts-datatable"
               data-datatable-url="{% url 'conflicts_datatables' %}"
               data-datatable-data='conflictFilter'
               class="sticky-header classification-table"
               data-adjust-columns="false"
        ></table>
    </div>
{% endblock %}