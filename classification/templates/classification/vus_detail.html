{% load classification_tags %}
{% load english_tags %}
{% load ui_utils %}
{% load ui_tabs_builder %}
<style>
    .criteria-cell {
        padding: 0 !important;
        text-align: center;
        vertical-align: middle !important;
        position: relative;
    }
    .criteria-cell .crit-values {
        position: absolute;
        width: 100%;
        bottom: 0;
        top: 0;
    }
</style>

<h5>VUS Overlaps</h5>

<table class="table sticky-header" id="vus_detail_table">
    <thead>
        <tr>
            <th>c.HGVS/Lab Lab/Clinical Significance</th>
            <th class="text-right" style="width:30px">Highest Score</th>
            <th class="text-right" style="width:30px">Patients Seen</th>
            <th style="width:5%" class="compact text-center">PS4</th>
            <th style="width:5%" class="compact text-center">PP1<br/>BS4</th>
            <th style="width:5%" class="compact text-center">PM6</th>
            <th style="width:5%" class="compact text-center">PS2</th>
            <th style="width:5%" class="compact text-center">BP2</th>
            <th style="width:5%" class="compact text-center">PM3</th>
            <th style="width:5%" class="compact text-center">PP4</th>
            <th style="width:5%" class="compact text-center">PS3<br/>BS3</th>
        </tr>
    </thead>
    <tbody>
        {% for grouping in overlaps.overlaps_vus %}
            <tr>
                <td>
                    <a href="{{ grouping.allele.get_absolute_url }}" class="hover-link">
                    {% for hgvs in grouping.c_hgvses %}
                        <div>{% c_hgvs hgvs %}</div>
                    {% endfor %}
                    </a>
                    <div>
                        <a class="hover-link" href="{% url 'classification_diff' %}?allele={{ grouping.allele.pk }}">Show Diffs</a>
                    </div>
                    {% classification_lab_summaries grouping.lab_clinical_significances shared=grouping.shared include_acmg=True %}
                </td>
                {% with strengths=grouping.strengths_for_latest_lab %}
                    <td class="text-right text-monospace" style="vertical-align:middle;font-size:10pt" data-order="{{ strengths.max_points|stringformat:"02d" }}">{% if strengths.has_non_standard %}<span class="hover-detail" title="1 or more submitting labs are not using ACMG, ACMG Points could not be calculated accurately for those labs">{{ strengths.max_points }}*</span>{% else %}{{ strengths.max_points }}&nbsp;{% endif %}</td>
                    <td class="text-right text-monospace" style="vertical-align:middle;font-size:10pt" data-order="{{ grouping.patient_counts.total_minimum|stringformat:"02d" }}">{% if grouping.patient_counts.consolidating_labs %}<span class="hover-detail" title="1 or more submitting labs only provide 1 classification per variant">{{ grouping.patient_counts.total_minimum }}<span style="font-weight: 600">+</span></span>{% else %}{{ grouping.patient_counts.total_minimum }}&nbsp;{% endif %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.ps4 %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.pp1_bs4 %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.pm6 %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.ps2 %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.bp2 %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.pm3 %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.pp4 %}</td>
                    <td class="criteria-cell">{% criteria_strengths strengths.ps3_bs3 %}</td>
                {% endwith %}
                </tr>
            {% empty %}<td colspan="11">No Records</td>
        {% endfor %}
    </tbody>
</table>
<script>
    $('#vus_detail_table').DataTable({
        paging: false,
        columns: [
            {},
            {},
            {},
            {orderable: false},
            {orderable: false},
            {orderable: false},
            {orderable: false},
            {orderable: false},
            {orderable: false},
            {orderable: false}
        ]
    });
</script>