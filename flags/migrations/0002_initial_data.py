# Generated by Django 3.1 on 2020-09-29 06:07

from django.db import migrations

from library.django_utils import bulk_insert_class_data


def flags_initial_data(apps, _schema_editor):
    FLAG_RESOLUTION = [
        {'id': 'rejected', 'description': 'This is rejected', 'label': 'Rejected', 'status': 'R'},
        {'id': 'sc_other', 'description': 'Other, please detail in the comments', 'label': 'Other', 'status': 'C'},
        {'id': 'open', 'description': 'This is ongoing', 'label': 'In Progress', 'status': 'O'},
        {'id': 'closed', 'description': 'This is complete', 'label': 'Completed', 'status': 'C'},
        {'id': 'sc_discordance_discussion',
         'description': 'Discussion with other labs during discordance highlighted data that changed the clinical significance',
         'label': 'Discordance Discussion', 'status': 'C'},
        {'id': 'sc_new_data',
         'description': 'New data became available (outside of discordance discussion) such as new classifications',
         'label': 'Summation of Data', 'status': 'C'},
        {'id': 'sc_internal_review',
         'description': 'New data became available during an internal review such as new classifications',
         'label': 'Internal Review', 'status': 'C'},
        {'id': 'in_error', 'description': 'There are outstanding errors for this record', 'label': 'In Error',
         'status': 'O'},
        {'id': 'matching_failed', 'description': 'Could not match this record to a variant', 'label': 'Matching Failed',
         'status': 'O'},
        {'id': 'vm_confirmed', 'description': 'The variant matching has been reviewed and determined to be correct',
         'label': 'Variant Confirmed', 'status': 'C'},
        {'id': 'tv_accepted', 'description': 'The change of transcript version is deemed acceptable',
         'label': 'Change Accepted', 'status': 'C'},
        {'id': 'tv_rejected', 'description': 'The change of transcript version is deemed not-acceptable',
         'label': 'Change Rejected', 'status': 'O'},
        {'id': 'vm_rejected',
         'description': 'The variant matched has been determined not to be the one intended by this record',
         'label': 'Variant Rejected', 'status': 'O'},
        {'id': 'withdrawn', 'description': 'The record is withdrawn and is no longer considered', 'label': 'Withdrawn',
         'status': 'O'},
        {'id': 'unwithdrawn', 'description': 'The record was unwithdrawn and is considered again',
         'label': 'Un-Withdrawn', 'status': 'C'},
    ]

    FLAG_TYPE_CONTEXT = [
        {'id': 'classification',
         'label': 'Flags for Classifications'},
        {'id': 'clinical_context', 'label': 'Flags for Clinical Context Groups'},
        {'id': 'allele', 'label': 'Flags for Alleles'}
    ]

    FLAG_TYPE = [
        {'id': 'allele_37_not_38',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'allele',
         'description': 'The c.hgvs for GRCh37 and GRCh38 do not match',
         'help_text': '',
         'importance': 2,
         'label': 'Mismatched c.hgvs',
         'only_one': False,
         'permission': 'O',
         'raise_permission': 'A'},
        {'id': 'allele_missing_37',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'allele',
         'description': 'This allele does not have a variant entry for GRCh37',
         'help_text': '',
         'importance': 2,
         'label': 'Missing variant for GRCh37',
         'only_one': True,
         'permission': 'O',
         'raise_permission': 'A'},
        {'id': 'allele_missing_38',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'allele',
         'description': 'This allele does not have a variant entry for GRCh38',
         'help_text': '',
         'importance': 2,
         'label': 'Missing Variant for GRCh38',
         'only_one': True,
         'permission': 'O',
         'raise_permission': 'A'},
        {'id': 'clinical_context_discordance',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'clinical_context',
         'description': 'This clinical group contains shared classifications that are discordant with each other.',
         'help_text': '',
         'importance': 2,
         'label': 'Discordance',
         'only_one': True,
         'permission': 'A',
         'raise_permission': 'A'},
        {'id': 'classification_clinical_context_change',
         'attributes': {},
         'comments_enabled': False,
         'context_id': 'classification',
         'description': 'This classification has been placed into another clinical grouping.',
         'help_text': '',
         'importance': 2,
         'label': 'Clinical Grouping Changed',
         'only_one': False,
         'permission': 'A',
         'raise_permission': 'A'},
        {'id': 'classification_discordant',
         'attributes': {},
         'comments_enabled': False,
         'context_id': 'classification',
         'description': 'This classification is being reviewed. Data presented here may change.',
         'help_text': 'Have a look at the latest Discordance Report, from there you can initiate conversations with other labs. Be sure to raise flags for any reviews this classification is involved in.',
         'importance': 2,
         'label': 'Discordance',
         'only_one': True,
         'permission': 'A',
         'raise_permission': 'A'},
        {'id': 'classification_internal_review',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'classification',
         'description': 'This classification is being internally reviewed.',
         'help_text': '',
         'importance': 2,
         'label': 'Internal Review',
         'only_one': False,
         'permission': 'O',
         'raise_permission': 'O'},
        {'id': 'classification_matching_variant',
         'attributes': {},
         'comments_enabled': False,
         'context_id': 'classification',
         'description': 'This classification is being processed to match it to an existing or newly annotated variant in the system',
         'help_text': '',
         'importance': 1,
         'label': 'Matching Variant',
         'only_one': True,
         'permission': 'A',
         'raise_permission': 'A'},
        {'id': 'classification_matching_variant_warning',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'classification',
         'description': 'This classification has been matched to a variant, but the match needs to be confirmed/rejected due to some uncertainty',
         'help_text': '',
         'importance': 2,
         'label': 'Matching Variant Warning',
         'only_one': True,
         'permission': 'O',
         'raise_permission': 'A'},
        {'id': 'classification_outstanding_edits',
         'attributes': {},
         'comments_enabled': False,
         'context_id': 'classification',
         'description': 'This classification has been edited since it was last submitted. Please click on the Tick icon to submit these new changes when appropriate.',
         'help_text': '',
         'importance': 0,
         'label': 'Un-submitted Edits',
         'only_one': True,
         'permission': 'A',
         'raise_permission': 'A'},
        {'id': 'classification_significance_change',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'classification',
         'description': 'This classification has had its clinical significance changed since it was last published. Please document here what caused the change.',
         'help_text': '',
         'importance': 2,
         'label': 'Significance Change',
         'only_one': False,
         'permission': 'O',
         'raise_permission': 'A'},
        {'id': 'classification_submitted',
         'attributes': {},
         'comments_enabled': False,
         'context_id': 'classification',
         'description': "This classification is currently in review and it's clinical significance should not be considered final",
         'help_text': '',
         'importance': 1,
         'label': 'Submitted',
         'only_one': False,
         'permission': 'A',
         'raise_permission': 'A'},
        {'id': 'classification_suggestion',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'classification',
         'description': 'Suggestion that one or more fields for this classification should be changed.',
         'help_text': 'Review the suggestion made here.\nIf the suggestion will result in a change of data, update the record in your curation system and mark the suggestion as Closed.\nIf after reviewing you intend to make no change, click Reject,',
         'importance': 2,
         'label': 'Suggestion',
         'only_one': False,
         'permission': 'O',
         'raise_permission': 'U'},
        {'id': 'classification_transcript_version_change',
         'attributes': {},
         'comments_enabled': True,
         'context_id': 'classification',
         'description': 'Our system does not have a copy of the transcript at the desired version and had to change it from what was imported',
         'help_text': '',
         'importance': 2,
         'label': 'Transcript Version Change',
         'only_one': True,
         'permission': 'O',
         'raise_permission': 'A'},
        {'id': 'classification_unshared',
         'attributes': {},
         'comments_enabled': False,
         'context_id': 'classification',
         'description': 'This classification has not yet been shared outside your organisation',
         'help_text': '',
         'importance': 0,
         'label': 'Unshared Classification',
         'only_one': False,
         'permission': 'A',
         'raise_permission': 'A'},
        {'id': 'classification_withdrawn',
         'attributes': {},
         'comments_enabled': False,
         'context_id': 'classification',
         'description': 'This classification has been withdrawn, no guarentee is made about the quality of the data.',
         'help_text': '',
         'importance': 1,
         'label': 'Classification Withdrawn',
         'only_one': True,
         'permission': 'A',
         'raise_permission': 'A'}
    ]

    FLAG_TYPE_RESOLUTION = [
        {'flag_type_id': 'classification_discordant',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_discordant',
         'resolution_id': 'closed'},
        {'flag_type_id': 'classification_suggestion',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_suggestion',
         'resolution_id': 'closed'},
        {'flag_type_id': 'classification_suggestion',
         'resolution_id': 'rejected'},
        {'flag_type_id': 'classification_clinical_context_change',
         'resolution_id': 'closed'},
        {'flag_type_id': 'classification_outstanding_edits',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_outstanding_edits',
         'resolution_id': 'closed'},
        {'flag_type_id': 'clinical_context_discordance', 'resolution_id': 'open'},
        {'flag_type_id': 'clinical_context_discordance', 'resolution_id': 'closed'},
        {'flag_type_id': 'classification_unshared', 'resolution_id': 'open'},
        {'flag_type_id': 'classification_unshared',
         'resolution_id': 'closed'},
        {'flag_type_id': 'classification_matching_variant',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_matching_variant',
         'resolution_id': 'closed'},
        {'flag_type_id': 'classification_submitted',
         'resolution_id': 'closed'},
        {'flag_type_id': 'classification_internal_review',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_internal_review',
         'resolution_id': 'closed'},
        {'flag_type_id': 'classification_significance_change',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_significance_change',
         'resolution_id': 'sc_discordance_discussion'},
        {'flag_type_id': 'classification_significance_change',
         'resolution_id': 'sc_new_data'},
        {'flag_type_id': 'classification_significance_change',
         'resolution_id': 'sc_internal_review'},
        {'flag_type_id': 'classification_outstanding_edits',
         'resolution_id': 'in_error'},
        {'flag_type_id': 'classification_matching_variant',
         'resolution_id': 'matching_failed'},
        {'flag_type_id': 'classification_matching_variant_warning',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_matching_variant_warning',
         'resolution_id': 'vm_confirmed'},
        {'flag_type_id': 'classification_matching_variant_warning',
         'resolution_id': 'vm_rejected'},
        {'flag_type_id': 'allele_missing_37', 'resolution_id': 'open'},
        {'flag_type_id': 'allele_missing_37', 'resolution_id': 'closed'},
        {'flag_type_id': 'allele_missing_38', 'resolution_id': 'open'},
        {'flag_type_id': 'allele_missing_38', 'resolution_id': 'closed'},
        {'flag_type_id': 'allele_37_not_38', 'resolution_id': 'open'},
        {'flag_type_id': 'allele_37_not_38', 'resolution_id': 'closed'},
        {'flag_type_id': 'classification_transcript_version_change',
         'resolution_id': 'open'},
        {'flag_type_id': 'classification_transcript_version_change',
         'resolution_id': 'tv_accepted'},
        {'flag_type_id': 'classification_transcript_version_change',
         'resolution_id': 'tv_rejected'},
        {'flag_type_id': 'classification_withdrawn',
         'resolution_id': 'withdrawn'},
        {'flag_type_id': 'classification_withdrawn',
         'resolution_id': 'unwithdrawn'}
    ]

    FLAG_MODELS = [
        ("FlagResolution", FLAG_RESOLUTION),
        ("FlagTypeContext", FLAG_TYPE_CONTEXT),
        ("FlagType", FLAG_TYPE),
        ("FlagTypeResolution", FLAG_TYPE_RESOLUTION),
    ]

    bulk_insert_class_data(apps, "flags", FLAG_MODELS)


class Migration(migrations.Migration):

    dependencies = [
        ('flags', '0001_initial'),
    ]

    operations = [
        migrations.RunPython(flags_initial_data)
    ]
